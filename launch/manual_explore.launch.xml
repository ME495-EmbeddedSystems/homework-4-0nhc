<launch>
    <arg name="use_nubot_rviz" default="false" description="Launch Rviz in nubot or not." />
    <arg name="world" default="nubot_world.sdf" description="Which world to use." />
    <arg name="rviz_config" default="$(find-pkg-share nubot_nav)/rviz/slam.rviz" description="Customized Rviz configuration file."/>
    <arg name="use_sim_time" default="true" description="Use simulation clock or not." />
    <arg name="nav2_params" default="$(find-pkg-share nubot_nav)/config/nav2_params.yaml" />

    <!-- Launch nubot Simulation -->
    <include file="$(find-pkg-share nubot)/launch/simulate.launch.xml">
        <arg name="use_rviz" value="$(var use_nubot_rviz)" />
        <arg name="world" value="$(var world)" />
    </include>

    <!-- Launch Nav2 Stack -->
    <include file="$(find-pkg-share nav2_bringup)/launch/bringup_launch.py">
        <arg name="use_sim_time" value="$(var use_sim_time)"/>
        <arg name="params_file" value="$(var nav2_params)"/>
    </include>

    <!-- Launch Slam Toolbox -->
    <include file="$(find-pkg-share slam_toolbox)/launch/online_async_launch.py">
        <arg name="use_sim_time" value="$(var use_sim_time)"/>
    </include>

    <!-- Launch Rviz -->
    <node unless="$(var use_nubot_rviz)" pkg="rviz2" exec="rviz2" args="-d $(var rviz_config)"/>
</launch>